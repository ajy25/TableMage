2024-12-31 11:15:23 - Mage Log - A new _MageOptions object has been created with LLM build function: <function build_groq at 0x165e33e20> and multimodal LLM build function: None
2024-12-31 11:15:23 - Mage Log - GROQ LLM build function has been set to: functools.partial(<function build_groq at 0x165e33e20>, temperature=0.0, model='llama-3.3-70b-versatile')
2024-12-31 11:15:42 - Analyzer Log - Renamed variables 'Unnamed: 0', 'area error', 'compactness error', 'concave points error', 'concavity error', 'fractal dimension error', 'mean area', 'mean compactness', 'mean concave points', 'mean concavity', 'mean fractal dimension', 'mean perimeter', 'mean radius', 'mean smoothness', 'mean symmetry', 'mean texture', 'perimeter error', 'radius error', 'smoothness error', 'symmetry error', 'texture error', 'worst area', 'worst compactness', 'worst concave points', 'worst concavity', 'worst fractal dimension', 'worst perimeter', 'worst radius', 'worst smoothness', 'worst symmetry', 'worst texture' to 'Unnamed:_0', 'area_error', 'compactness_error', 'concave_points_error', 'concavity_error', 'fractal_dimension_error', 'mean_area', 'mean_compactness', 'mean_concave_points', 'mean_concavity', 'mean_fractal_dimension', 'mean_perimeter', 'mean_radius', 'mean_smoothness', 'mean_symmetry', 'mean_texture', 'perimeter_error', 'radius_error', 'smoothness_error', 'symmetry_error', 'texture_error', 'worst_area', 'worst_compactness', 'worst_concave_points', 'worst_concavity', 'worst_fractal_dimension', 'worst_perimeter', 'worst_radius', 'worst_smoothness', 'worst_symmetry', 'worst_texture'.
2024-12-31 11:15:42 - Analyzer Log - Analyzer initialized for dataset 'Unnamed Dataset'.
2024-12-31 11:15:42 - Mage Log - Data container initialized with the Analyzer built from the provided DataFrame.
2024-12-31 11:15:42 - Mage Log - IO initialized.
2024-12-31 11:15:42 - Mage Log - Initializing the Orchestrator.
2024-12-31 11:15:42 - Mage Log - Initializing SingleAgent
2024-12-31 11:15:43 - Mage Log - Adding dictionary to storage.
2024-12-31 11:15:43 - Mage Log - Added dictionary without description. First 20 characters: {"train_shape": {"n_.
2024-12-31 11:15:46 - Mage Log - SingleAgent initialized
2024-12-31 11:15:51 - Mage Log - Executing Python code in a separate subprocess with preloaded DataFrames. Input code: 
result = df_all.columns.tolist()
2024-12-31 11:16:22 - Mage Log - _ml_classification_function called
2024-12-31 11:16:22 - Mage Log - _ml_classification_function Models to test: Logistic, RF, XGBoost
2024-12-31 11:16:22 - Mage Log - _ml_classification_function Target: breast_cancer_yn
2024-12-31 11:16:22 - Mage Log - _ml_classification_function Predictors: ['area_error', 'compactness_error', 'concave_points_error', 'concavity_error', 'fractal_dimension_error', 'mean_area', 'mean_compactness', 'mean_concave_points', 'mean_concavity', 'mean_fractal_dimension', 'mean_perimeter', 'mean_radius', 'mean_smoothness', 'mean_symmetry', 'mean_texture', 'perimeter_error', 'radius_error', 'smoothness_error', 'symmetry_error', 'texture_error', 'worst_area', 'worst_compactness', 'worst_concave_points', 'worst_concavity', 'worst_fractal_dimension', 'worst_perimeter', 'worst_radius', 'worst_smoothness', 'worst_symmetry', 'worst_texture']
2024-12-31 11:16:22 - Analyzer Log - Fitting model 'Logistic'.
2024-12-31 11:16:22 - Analyzer Log - Fitting 'Logistic'. Search method: GridSearchCV (1 fits per fold, 5 total fits). 
2024-12-31 11:16:22 - Analyzer Log - Optimal threshold set for 'Logistic' via roc.
2024-12-31 11:16:22 - Analyzer Log - Successfully fitted model 'Logistic'.
2024-12-31 11:16:22 - Analyzer Log - Fitting model 'RF'.
2024-12-31 11:16:22 - Analyzer Log - Fitting 'RF'. Search method: OptunaSearchCV (100 trials, 500 total fits). 
2024-12-31 11:16:56 - Analyzer Log - Optimal threshold set for 'RF' via roc.
2024-12-31 11:16:56 - Analyzer Log - Successfully fitted model 'RF'.
2024-12-31 11:16:56 - Analyzer Log - Fitting model 'XGBoost'.
2024-12-31 11:16:56 - Analyzer Log - Fitting 'XGBoost'. Search method: OptunaSearchCV (100 trials, 500 total fits). 
2024-12-31 11:17:20 - Analyzer Log - Optimal threshold set for 'XGBoost' via roc.
2024-12-31 11:17:20 - Analyzer Log - Successfully fitted model 'XGBoost'.
2024-12-31 11:17:20 - Mage Log - Adding table to storage.
2024-12-31 11:17:20 - Mage Log - Added table to /Users/andrewyang/Desktop/research/TableMage/tablemage/agents/_src/io/_table_store/0.pkl: Path to table: /Users/andrewyang/Desktop/research/TableMage/tablemage/agents/_src/io/_table_store/0.pkl

{"('train', 'accuracy')": {"Logistic": 0.971, "RF": 0.998, "XGBoost": 0.998}, "('train', 'f1')": {"Logistic": 0.977, "RF": 0.998, "XGBoost": 0.998}, "('train', 'precision')": {"Logistic": 0.993, "RF": 1.0, "XGBoost": 1.0}, "('train', 'recall')": {"Logistic": 0.962, "RF": 0.997, "XGBoost": 0.997}, "('train', 'roc_auc')": {"Logistic": 0.995, "RF": 1.0, "XGBoost": 1.0}, "('train', 'n_obs')": {"Logistic": 455.0, "RF": 455.0, "XGBoost": 455.0}, "('test', 'accuracy')": {"Logistic": 0.947, "RF": 0.956, "XGBoost": 0.956}, "('test', 'f1')": {"Logistic": 0.957, "RF": 0.965, "XGBoost": 0.964}, "('test', 'precision')": {"Logistic": 0.971, "RF": 0.958, "XGBoost": 0.985}, "('test', 'recall')": {"Logistic": 0.944, "RF": 0.972, "XGBoost": 0.944}, "('test', 'roc_auc')": {"Logistic": 0.995, "RF": 0.997, "XGBoost": 0.995}, "('test', 'n_obs')": {"Logistic": 114.0, "RF": 114.0, "XGBoost": 114.0}}
2024-12-31 11:17:20 - Mage Log - Adding dictionary to storage.
2024-12-31 11:17:20 - Mage Log - Added dictionary without description. First 20 characters: {"train_metrics": {".
2024-12-31 11:18:03 - Analyzer Log - Renamed variables 'Unnamed: 0' to 'Unnamed:_0'.
2024-12-31 11:18:03 - Analyzer Log - Analyzer initialized for dataset 'Unnamed Dataset'.
2024-12-31 11:18:03 - Mage Log - Data container initialized with the Analyzer built from the provided DataFrame.
2024-12-31 11:18:03 - Mage Log - IO initialized.
2024-12-31 11:18:03 - Mage Log - Initializing the Orchestrator.
2024-12-31 11:18:03 - Mage Log - Initializing SingleAgent
2024-12-31 11:18:04 - Mage Log - Adding dictionary to storage.
2024-12-31 11:18:04 - Mage Log - Added dictionary without description. First 20 characters: {"train_shape": {"n_.
2024-12-31 11:18:07 - Mage Log - SingleAgent initialized
2024-12-31 11:18:46 - Mage Log - _feature_selection_function called
2024-12-31 11:18:46 - Mage Log - _feature_selection_function Feature selector: Select2Best
2024-12-31 11:18:46 - Mage Log - _feature_selection_function Target: wine_class
2024-12-31 11:18:46 - Mage Log - _feature_selection_function Predictors: ['alcohol', 'flavanoids']
2024-12-31 11:18:46 - Analyzer Log - Fitting 'KBestFSC(f_classif)'.
2024-12-31 11:18:46 - Mage Log - Adding dictionary to storage.
2024-12-31 11:18:46 - Mage Log - Added dictionary without description. First 20 characters: {"target": "wine_cla.
2024-12-31 11:18:46 - Mage Log - _logit_function call: predictors: alcohol, flavanoids, target: wine_class
2024-12-31 11:18:47 - Mage Log - _ml_classification_function called
2024-12-31 11:18:47 - Mage Log - _ml_classification_function Models to test: Logistic, RF, XGBoost
2024-12-31 11:18:47 - Mage Log - _ml_classification_function Target: wine_class
2024-12-31 11:18:47 - Mage Log - _ml_classification_function Predictors: ['alcohol', 'flavanoids']
2024-12-31 11:18:47 - Analyzer Log - Fitting model 'Logistic'.
2024-12-31 11:18:47 - Analyzer Log - Fitting 'Logistic'. Search method: GridSearchCV (1 fits per fold, 5 total fits). 
2024-12-31 11:18:47 - Analyzer Log - Optimal thresholds set for 'Logistic' via roc.
2024-12-31 11:18:47 - Analyzer Log - Successfully fitted model 'Logistic'.
2024-12-31 11:18:47 - Analyzer Log - Fitting model 'RF'.
2024-12-31 11:18:47 - Analyzer Log - Fitting 'RF'. Search method: OptunaSearchCV (100 trials, 500 total fits). 
2024-12-31 11:19:21 - Analyzer Log - Optimal thresholds set for 'RF' via roc.
2024-12-31 11:19:21 - Analyzer Log - Successfully fitted model 'RF'.
2024-12-31 11:19:21 - Analyzer Log - Fitting model 'XGBoost'.
2024-12-31 11:19:21 - Analyzer Log - Fitting 'XGBoost'. Search method: OptunaSearchCV (100 trials, 500 total fits). 
2024-12-31 11:21:22 - Analyzer Log - Optimal thresholds set for 'XGBoost' via roc.
2024-12-31 11:21:22 - Analyzer Log - Successfully fitted model 'XGBoost'.
2024-12-31 11:21:22 - Mage Log - Adding table to storage.
2024-12-31 11:21:22 - Mage Log - Added table to /Users/andrewyang/Desktop/research/TableMage/tablemage/agents/_src/io/_table_store/0.pkl: Path to table: /Users/andrewyang/Desktop/research/TableMage/tablemage/agents/_src/io/_table_store/0.pkl

{"('train', 'accuracy')": {"Logistic": 0.93, "RF": 0.993, "XGBoost": 0.958}, "('train', 'f1')": {"Logistic": 0.932, "RF": 0.993, "XGBoost": 0.958}, "('train', 'precision')": {"Logistic": 0.932, "RF": 0.994, "XGBoost": 0.956}, "('train', 'recall')": {"Logistic": 0.942, "RF": 0.993, "XGBoost": 0.962}, "('train', 'roc_auc(ovo)')": {"Logistic": 0.986, "RF": 1.0, "XGBoost": 0.997}, "('train', 'n_obs')": {"Logistic": 142.0, "RF": 142.0, "XGBoost": 142.0}, "('test', 'accuracy')": {"Logistic": 0.917, "RF": 0.917, "XGBoost": 0.889}, "('test', 'f1')": {"Logistic": 0.911, "RF": 0.91, "XGBoost": 0.878}, "('test', 'precision')": {"Logistic": 0.911, "RF": 0.91, "XGBoost": 0.876}, "('test', 'recall')": {"Logistic": 0.929, "RF": 0.911, "XGBoost": 0.887}, "('test', 'roc_auc(ovo)')": {"Logistic": 0.999, "RF": 0.959, "XGBoost": 0.976}, "('test', 'n_obs')": {"Logistic": 36.0, "RF": 36.0, "XGBoost": 36.0}}
2024-12-31 11:21:25 - Mage Log - Executing Python code in a separate subprocess with preloaded DataFrames. Input code: 
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

X = df_all[['alcohol', 'flavanoids']]
y = df_all['wine_class']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = RandomForestClassifier(n_estimators=100)
model.fit(X_train, y_train)
y_pred = model.predict(X_test)

accuracy = accuracy_score(y_test, y_pred)
print(f'Accuracy: {accuracy:.3f}')

